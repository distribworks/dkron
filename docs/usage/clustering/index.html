<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-usage/clustering" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Clustering | Dkron</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://dkron.io/docs/usage/clustering"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Clustering | Dkron"><meta data-rh="true" name="description" content="High Availability Clustering"><meta data-rh="true" property="og:description" content="High Availability Clustering"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://dkron.io/docs/usage/clustering"><link data-rh="true" rel="alternate" href="https://dkron.io/docs/usage/clustering" hreflang="en"><link data-rh="true" rel="alternate" href="https://dkron.io/docs/usage/clustering" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://M5K5E6F8F3-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Clustering","item":"https://dkron.io/docs/usage/clustering"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Dkron RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Dkron Atom Feed">





<link rel="search" type="application/opensearchdescription+xml" title="Dkron" href="/opensearch.xml">


<script src="/js/linkedin.js" defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.4ce8ab2f.css">
<script src="/assets/js/runtime~main.d6fb5bc4.js" defer="defer"></script>
<script src="/assets/js/main.fc2c6510.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_XRY4" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/dkron-logo-black.png" alt="Dkron Logo" class="themedComponent_wC9N themedComponent--light_T_OS"><img src="/img/dkron-logo-black.png" alt="Dkron Logo" class="themedComponent_wC9N themedComponent--dark_y3IB"></div><b class="navbar__title text--truncate"></b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/basics/getting-started">Docs</a><a class="navbar__item navbar__link" href="/api/">API</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/license">License</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/usage/clustering">v4</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/usage/clustering">v4</a></li><li><a class="dropdown__link" href="/docs/v3/usage/clustering">v3</a></li><li><a class="dropdown__link" href="/docs/v2/usage/clustering">v2</a></li><li><a class="dropdown__link" href="/docs/v1/usage/clustering">v1</a></li></ul></div><a class="navbar__item navbar__link navbar-link-go-pro" href="/pro/">PRO</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/distribworks/dkron" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_qkBQ"><use href="#theme-svg-external-link"></use></svg></a><div class="navbarSearchContainer_hjbF"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_xEj_"><div class="docsWrapper_RZ8f"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_viJ1" type="button"></button><div class="docRoot_LRAe"><aside class="theme-doc-sidebar-container docSidebarContainer_adD_"><div class="sidebarViewport_rqXg"><div class="sidebar_cWOd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_ZJ4F"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_l3jO menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/basics/getting-started"><span title="Basics" class="categoryLinkLabel_L21k">Basics</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro"><span title="Intro" class="linkLabel_l67t">Intro</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_l3jO menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/usage/chaining"><span title="Usage" class="categoryLinkLabel_L21k">Usage</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/chaining"><span title="Job chaining" class="linkLabel_l67t">Job chaining</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/cloud-auto-join"><span title="Cloud Auto-join" class="linkLabel_l67t">Cloud Auto-join</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/usage/clustering"><span title="Clustering" class="linkLabel_l67t">Clustering</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/concepts"><span title="Concepts" class="linkLabel_l67t">Concepts</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/concurrency"><span title="Concurrency" class="linkLabel_l67t">Concurrency</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/cron-spec"><span title="Cron Specification" class="linkLabel_l67t">Cron Specification</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/cronitor"><span title="Cronitor Integration" class="linkLabel_l67t">Cronitor Integration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/ecs"><span title="Use with AWS ECS" class="linkLabel_l67t">Use with AWS ECS</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_l3jO menu__link menu__link--sublist" tabindex="0" href="/docs/usage/executors/"><span title="Executors" class="categoryLinkLabel_L21k">Executors</span></a><button aria-label="Expand sidebar category &#x27;Executors&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/metatags"><span title="Job metadata" class="linkLabel_l67t">Job metadata</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/metrics"><span title="Metrics" class="linkLabel_l67t">Metrics</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_l3jO menu__link menu__link--sublist" tabindex="0" href="/docs/usage/plugins/"><span title="Plugins" class="categoryLinkLabel_L21k">Plugins</span></a><button aria-label="Expand sidebar category &#x27;Plugins&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_l3jO menu__link menu__link--sublist" tabindex="0" href="/docs/usage/processors/"><span title="Processors" class="categoryLinkLabel_L21k">Processors</span></a><button aria-label="Expand sidebar category &#x27;Processors&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/recovery"><span title="Outage recovery" class="linkLabel_l67t">Outage recovery</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/retries"><span title="Job retries" class="linkLabel_l67t">Job retries</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/storage"><span title="Embedded storage" class="linkLabel_l67t">Embedded storage</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/target-nodes-spec"><span title="Target nodes spec" class="linkLabel_l67t">Target nodes spec</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/usage/upgrade"><span title="Upgrade methods" class="linkLabel_l67t">Upgrade methods</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_l3jO menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/cli/dkron"><span title="CLI" class="categoryLinkLabel_L21k">CLI</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_l3jO menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/pro/acls"><span title="Pro" class="categoryLinkLabel_L21k">Pro</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_l3jO menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/upgrading/from_v1_to_v2"><span title="Upgrading" class="categoryLinkLabel_L21k">Upgrading</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_uX8_"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Dcb3"><div class="docItemContainer_U8Ju"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_ouZM" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_T_oX"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Usage</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Clustering</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v4</span><div class="tocCollapsible_e9k4 theme-doc-toc-mobile tocMobile_V66e"><button type="button" class="clean-btn tocCollapsibleButton_AjWg">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Clustering</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_BjIu" id="high-availability-clustering">High Availability Clustering<a href="#high-availability-clustering" class="hash-link" aria-label="Direct link to High Availability Clustering" title="Direct link to High Availability Clustering" translate="no">​</a></h2>
<p>Dkron is designed to operate as a cluster of multiple nodes for fault tolerance and high availability. This guide explains how to set up and manage a Dkron cluster.</p>
<!-- -->
<h2 class="anchor anchorTargetStickyNavbar_BjIu" id="cluster-formation">Cluster Formation<a href="#cluster-formation" class="hash-link" aria-label="Direct link to Cluster Formation" title="Direct link to Cluster Formation" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="bootstrap-methods">Bootstrap Methods<a href="#bootstrap-methods" class="hash-link" aria-label="Direct link to Bootstrap Methods" title="Direct link to Bootstrap Methods" translate="no">​</a></h3>
<p>Dkron supports several methods for nodes to discover and join each other:</p>
<ol>
<li class=""><strong>Static List</strong>: Explicitly specify other cluster members</li>
<li class=""><strong>Auto-join</strong>: Automatically discover other nodes</li>
<li class=""><strong>Cloud Auto-join</strong>: Discover nodes in cloud environments</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="basic-cluster-setup">Basic Cluster Setup<a href="#basic-cluster-setup" class="hash-link" aria-label="Direct link to Basic Cluster Setup" title="Direct link to Basic Cluster Setup" translate="no">​</a></h3>
<p>To start a basic 3-node server cluster:</p>
<ol>
<li class="">
<p><strong>Start the first node</strong>:</p>
<div class="language-text codeBlockContainer_MKBk theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_7Ypw"><pre tabindex="0" class="prism-code language-text codeBlock_Dl0Y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_nSJr"><span class="token-line" style="color:#393A34"><span class="token plain">dkron agent --server --bootstrap-expect=3 --node-name=node1 --bind=10.0.0.1 --advertise=10.0.0.1</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Start additional server nodes</strong>:</p>
<div class="language-text codeBlockContainer_MKBk theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_7Ypw"><pre tabindex="0" class="prism-code language-text codeBlock_Dl0Y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_nSJr"><span class="token-line" style="color:#393A34"><span class="token plain">dkron agent --server --bootstrap-expect=3 --node-name=node2 --bind=10.0.0.2 --advertise=10.0.0.2 --join=10.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dkron agent --server --bootstrap-expect=3 --node-name=node3 --bind=10.0.0.3 --advertise=10.0.0.3 --join=10.0.0.1</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>Add agent nodes</strong>:</p>
<div class="language-text codeBlockContainer_MKBk theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_7Ypw"><pre tabindex="0" class="prism-code language-text codeBlock_Dl0Y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_nSJr"><span class="token-line" style="color:#393A34"><span class="token plain">dkron agent --node-name=agent1 --bind=10.0.0.4 --join=10.0.0.1</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="key-configuration-parameters">Key Configuration Parameters<a href="#key-configuration-parameters" class="hash-link" aria-label="Direct link to Key Configuration Parameters" title="Direct link to Key Configuration Parameters" translate="no">​</a></h3>
<table><thead><tr><th>Parameter</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>--server</code></td><td>Run in server mode</td><td><code>--server</code></td></tr><tr><td><code>--bootstrap-expect</code></td><td>Expected number of servers</td><td><code>--bootstrap-expect=3</code></td></tr><tr><td><code>--node-name</code></td><td>Unique node identifier</td><td><code>--node-name=node1</code></td></tr><tr><td><code>--bind</code></td><td>Address to bind network services</td><td><code>--bind=10.0.0.1</code></td></tr><tr><td><code>--advertise</code></td><td>Address to advertise to cluster</td><td><code>--advertise=10.0.0.1</code></td></tr><tr><td><code>--join</code></td><td>Address of another node to join</td><td><code>--join=10.0.0.1</code></td></tr><tr><td><code>--retry-join</code></td><td>Auto-retry joining</td><td><code>--retry-join=10.0.0.1</code></td></tr><tr><td><code>--tag</code></td><td>Node tag for job targeting</td><td><code>--tag role=web</code></td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_BjIu" id="multi-datacenter-configuration">Multi-Datacenter Configuration<a href="#multi-datacenter-configuration" class="hash-link" aria-label="Direct link to Multi-Datacenter Configuration" title="Direct link to Multi-Datacenter Configuration" translate="no">​</a></h2>
<p>Dkron can run in HA mode, avoiding SPOFs, this mode provides better scalability and better reliability for users that wants a high level of confidence in the cron jobs they need to run.</p>
<p>Manually bootstrapping a Dkron cluster does not rely on additional tooling, but does require operator participation in the cluster formation process. When bootstrapping, Dkron servers and clients must be started and informed with the address of at least one Dkron server.</p>
<p>As you can tell, this creates a chicken-and-egg problem where one server must first be fully bootstrapped and configured before the remaining servers and clients can join the cluster. This requirement can add additional provisioning time as well as ordered dependencies during provisioning.</p>
<p>First, we bootstrap a single Dkron server and capture its IP address. After we have that nodes IP address, we place this address in the configuration.</p>
<ol>
<li class="">First bootstrap a node with a configuration like this:</li>
</ol>
<div class="language-yaml codeBlockContainer_MKBk theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_7Ypw"><pre tabindex="0" class="prism-code language-yaml codeBlock_Dl0Y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_nSJr"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># dkron.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">bootstrap-expect</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre></div></div>
<ol start="2">
<li class="">
<p>Then stop the bootstrapped server and capture the server IP address.</p>
</li>
<li class="">
<p>To form a cluster, configure server nodes (including the bootstrapped server) with the address of its peers as in the following example:</p>
</li>
</ol>
<div class="language-yaml codeBlockContainer_MKBk theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_7Ypw"><pre tabindex="0" class="prism-code language-yaml codeBlock_Dl0Y thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_nSJr"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># dkron.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">bootstrap-expect</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">retry-join</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 10.19.3.9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 10.19.4.64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 10.19.7.215</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_BjIu" id="deployment-table">Deployment Table<a href="#deployment-table" class="hash-link" aria-label="Direct link to Deployment Table" title="Direct link to Deployment Table" translate="no">​</a></h2>
<p>Below is a table that shows quorum size and failure tolerance for various
cluster sizes. The recommended deployment is either 3 or 5 servers. A single
server deployment is <em><strong>highly</strong></em> discouraged as data loss is inevitable in a
failure scenario.</p>
<table><thead><tr><th>Servers</th><th>Quorum Size</th><th>Failure Tolerance</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>0</td></tr><tr><td>2</td><td>2</td><td>0</td></tr><tr class="warning"><td>3</td><td>2</td><td>1</td></tr><tr><td>4</td><td>3</td><td>1</td></tr><tr class="warning"><td>5</td><td>3</td><td>2</td></tr><tr><td>6</td><td>4</td><td>2</td></tr><tr><td>7</td><td>4</td><td>3</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_BjIu" id="fault-tolerance-and-recovery">Fault Tolerance and Recovery<a href="#fault-tolerance-and-recovery" class="hash-link" aria-label="Direct link to Fault Tolerance and Recovery" title="Direct link to Fault Tolerance and Recovery" translate="no">​</a></h2>
<p>Dkron&#x27;s distributed architecture is designed to maintain operation even when nodes fail.</p>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="leader-failure-recovery">Leader Failure Recovery<a href="#leader-failure-recovery" class="hash-link" aria-label="Direct link to Leader Failure Recovery" title="Direct link to Leader Failure Recovery" translate="no">​</a></h3>
<p>When a leader node fails:</p>
<ol>
<li class="">Remaining server nodes detect the failure through gossip protocol</li>
<li class="">A new leader election is automatically triggered</li>
<li class="">A new leader is elected from the available server nodes</li>
<li class="">The new leader takes over scheduling responsibilities</li>
<li class="">All running jobs continue to operate without interruption</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="quorum-requirements">Quorum Requirements<a href="#quorum-requirements" class="hash-link" aria-label="Direct link to Quorum Requirements" title="Direct link to Quorum Requirements" translate="no">​</a></h3>
<ul>
<li class="">A cluster must maintain a quorum (majority) of server nodes to operate</li>
<li class="">For a cluster of size N, at least (N/2)+1 nodes must be available</li>
<li class="">If quorum is lost, the cluster stops scheduling new jobs until quorum is restored</li>
<li class="">Refer to the Deployment Table above for specific quorum sizes and failure tolerance</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="node-rejoining">Node Rejoining<a href="#node-rejoining" class="hash-link" aria-label="Direct link to Node Rejoining" title="Direct link to Node Rejoining" translate="no">​</a></h3>
<p>When a previously failed node rejoins the cluster:</p>
<ol>
<li class="">The node establishes connection with existing cluster members</li>
<li class="">It synchronizes its state with the current leader</li>
<li class="">If it was previously a leader, it joins as a follower</li>
<li class="">The node becomes available for job execution</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="data-recovery">Data Recovery<a href="#data-recovery" class="hash-link" aria-label="Direct link to Data Recovery" title="Direct link to Data Recovery" translate="no">​</a></h3>
<p>In case of catastrophic failure:</p>
<ol>
<li class="">Restore from backup if available</li>
<li class="">Bootstrap a new cluster with at least one server node</li>
<li class="">Import job definitions via API</li>
<li class="">New executions will begin according to schedule</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_BjIu" id="cluster-maintenance">Cluster Maintenance<a href="#cluster-maintenance" class="hash-link" aria-label="Direct link to Cluster Maintenance" title="Direct link to Cluster Maintenance" translate="no">​</a></h2>
<p>Proper maintenance ensures your Dkron cluster remains healthy and performant.</p>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="adding-nodes">Adding Nodes<a href="#adding-nodes" class="hash-link" aria-label="Direct link to Adding Nodes" title="Direct link to Adding Nodes" translate="no">​</a></h3>
<p>To add a new server node to an existing cluster:</p>
<ol>
<li class="">Install Dkron on the new server</li>
<li class="">Configure with appropriate server settings</li>
<li class="">Set <code>--join</code> parameter to point to existing cluster members</li>
<li class="">Start the Dkron process</li>
<li class="">Verify the node joins successfully via the web UI or API</li>
</ol>
<p>Adding agent nodes follows the same process but without the <code>--server</code> flag.</p>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="removing-nodes">Removing Nodes<a href="#removing-nodes" class="hash-link" aria-label="Direct link to Removing Nodes" title="Direct link to Removing Nodes" translate="no">​</a></h3>
<p>To gracefully remove a node:</p>
<ol>
<li class="">For agents: simply stop the Dkron service</li>
<li class="">For server nodes:<!-- -->
<ul>
<li class="">If possible, demote the node to an agent first</li>
<li class="">Ensure you maintain sufficient servers for quorum</li>
<li class="">Stop the Dkron service</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="upgrading-dkron">Upgrading Dkron<a href="#upgrading-dkron" class="hash-link" aria-label="Direct link to Upgrading Dkron" title="Direct link to Upgrading Dkron" translate="no">​</a></h3>
<p>For minimal disruption during upgrades:</p>
<ol>
<li class="">
<p><strong>Rolling Upgrade</strong> (recommended):</p>
<ul>
<li class="">Upgrade one node at a time</li>
<li class="">Start with agent nodes</li>
<li class="">Then upgrade server nodes, leaving the leader for last</li>
<li class="">Allow state synchronization between each node upgrade</li>
</ul>
</li>
<li class="">
<p><strong>Version Compatibility</strong>:</p>
<ul>
<li class="">Check release notes for compatibility information</li>
<li class="">Ensure all nodes in a cluster run compatible versions</li>
<li class="">Some upgrades may require special procedures</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="monitoring-cluster-health">Monitoring Cluster Health<a href="#monitoring-cluster-health" class="hash-link" aria-label="Direct link to Monitoring Cluster Health" title="Direct link to Monitoring Cluster Health" translate="no">​</a></h3>
<p>Regular health checks should include:</p>
<ol>
<li class=""><strong>Node Status</strong>: Check that all expected nodes are active</li>
<li class=""><strong>Leadership</strong>: Verify leader election is stable</li>
<li class=""><strong>Job Execution</strong>: Monitor successful job execution rates</li>
<li class=""><strong>Resource Usage</strong>: Track CPU, memory, and disk usage</li>
<li class=""><strong>Log Analysis</strong>: Review logs for errors or warnings</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_BjIu" id="backup-and-recovery">Backup and Recovery<a href="#backup-and-recovery" class="hash-link" aria-label="Direct link to Backup and Recovery" title="Direct link to Backup and Recovery" translate="no">​</a></h3>
<p>Implement a regular backup strategy:</p>
<ol>
<li class="">
<p><strong>Data Store Backup</strong>:</p>
<ul>
<li class="">Stop Dkron service or use backup-friendly commands</li>
<li class="">Copy the data directory to a secure location</li>
<li class="">Restart the service if stopped</li>
</ul>
</li>
<li class="">
<p><strong>Configuration Backup</strong>:</p>
<ul>
<li class="">Maintain copies of configuration files</li>
<li class="">Document any custom settings</li>
</ul>
</li>
<li class="">
<p><strong>Job Definition Export</strong>:</p>
<ul>
<li class="">Use the API to export job definitions</li>
<li class="">Store in version control for tracking changes</li>
</ul>
</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_dOC_"><a href="https://github.com/distribworks/dkron/tree/main/website/docs/docs/usage/clustering.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_TEaT" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_QwUn"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/usage/cloud-auto-join"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Cloud Auto-join</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/usage/concepts"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Concepts</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_sgE_ thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#high-availability-clustering" class="table-of-contents__link toc-highlight">High Availability Clustering</a></li><li><a href="#cluster-formation" class="table-of-contents__link toc-highlight">Cluster Formation</a><ul><li><a href="#bootstrap-methods" class="table-of-contents__link toc-highlight">Bootstrap Methods</a></li><li><a href="#basic-cluster-setup" class="table-of-contents__link toc-highlight">Basic Cluster Setup</a></li><li><a href="#key-configuration-parameters" class="table-of-contents__link toc-highlight">Key Configuration Parameters</a></li></ul></li><li><a href="#multi-datacenter-configuration" class="table-of-contents__link toc-highlight">Multi-Datacenter Configuration</a></li><li><a href="#deployment-table" class="table-of-contents__link toc-highlight">Deployment Table</a></li><li><a href="#fault-tolerance-and-recovery" class="table-of-contents__link toc-highlight">Fault Tolerance and Recovery</a><ul><li><a href="#leader-failure-recovery" class="table-of-contents__link toc-highlight">Leader Failure Recovery</a></li><li><a href="#quorum-requirements" class="table-of-contents__link toc-highlight">Quorum Requirements</a></li><li><a href="#node-rejoining" class="table-of-contents__link toc-highlight">Node Rejoining</a></li><li><a href="#data-recovery" class="table-of-contents__link toc-highlight">Data Recovery</a></li></ul></li><li><a href="#cluster-maintenance" class="table-of-contents__link toc-highlight">Cluster Maintenance</a><ul><li><a href="#adding-nodes" class="table-of-contents__link toc-highlight">Adding Nodes</a></li><li><a href="#removing-nodes" class="table-of-contents__link toc-highlight">Removing Nodes</a></li><li><a href="#upgrading-dkron" class="table-of-contents__link toc-highlight">Upgrading Dkron</a></li><li><a href="#monitoring-cluster-health" class="table-of-contents__link toc-highlight">Monitoring Cluster Health</a></li><li><a href="#backup-and-recovery" class="table-of-contents__link toc-highlight">Backup and Recovery</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Intro</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/dkron" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_qkBQ"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://gitter.im/distribworks/dkron" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_qkBQ"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/distribworks" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_qkBQ"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/distribworks/dkron" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_qkBQ"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Distributed Works. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>