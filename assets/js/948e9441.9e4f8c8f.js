"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3156],{14608:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var s=t(17624),o=t(4552);const i={title:"Getting started",weight:30},r=void 0,a={id:"basics/getting-started",title:"Getting started",description:"Introduction",source:"@site/versioned_docs/version-v1/basics/getting-started.md",sourceDirName:"basics",slug:"/basics/getting-started",permalink:"/docs/v1/basics/getting-started",draft:!1,unlisted:!1,editUrl:"https://github.com/distribworks/dkron/tree/main/website/docs/versioned_docs/version-v1/basics/getting-started.md",tags:[],version:"v1",frontMatter:{title:"Getting started",weight:30},sidebar:"tutorialSidebar",previous:{title:"Configuration",permalink:"/docs/v1/basics/configuration"},next:{title:"installation",permalink:"/docs/v1/basics/installation"}},l={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Backend stores",id:"backend-stores",level:2},{value:"Installation",id:"installation",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Usage",id:"usage",level:2},{value:"To start configuring an HA installation of Dkron follow the clustering guide",id:"to-start-configuring-an-ha-installation-of-dkron-follow-the-clustering-guide",level:4}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,s.jsx)(n.p,{children:"Dkron nodes can work in two modes, agents or servers."}),"\n",(0,s.jsx)(n.p,{children:"A Dkron agent is a cluster member that can handle job executions, run your scripts and return the resulting output to the server."}),"\n",(0,s.jsx)(n.p,{children:"A Dkron server is also a cluster member that send job execution queries to agents or other servers, so servers can execute jobs too."}),"\n",(0,s.jsx)(n.p,{children:"The main distinction is that servers order job executions, can be used to schedule jobs, handles data storage and participate on leader election."}),"\n",(0,s.jsx)(n.p,{children:"Dkron clusters have a leader, the leader is responsible of starting job execution queries in the cluster."}),"\n",(0,s.jsx)(n.p,{children:"Any Dkron agent or server acts as a cluster member and it's available to run scheduled jobs."}),"\n",(0,s.jsx)(n.p,{children:"You can choose whether a job is run on a node or nodes by specifying tags and a count of target nodes having this tag do you want a job to run. This gives an unprecedented level of flexibility in runnig jobs across a cluster of any size and with any combination of machines you need."}),"\n",(0,s.jsx)(n.p,{children:"All the execution responses will be gathered by the scheduler and stored in the database."}),"\n",(0,s.jsx)(n.h2,{id:"backend-stores",children:"Backend stores"}),"\n",(0,s.jsx)(n.p,{children:"Dkron relies on the key-value store for data storage, an instance of the distributed store can be run in the same machines as Dkron or connect it to an already existing cluster."}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"By default dkron will start with a file based, embedded KV store called BoltDB, it is functional for a single node demo but does not offers clustering or HA."})}),"\n",(0,s.jsx)(n.p,{children:"It is compatible with etcd, Consul, Zookeeper, Redis, DynamoDB and BoltDB. For instructions on how to install and configure any one of these systems refer to their official sites:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://coreos.com/etcd/docs/latest/",children:"etcd"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://consul.io/intro/getting-started/install.html",children:"Consul"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://zookeeper.apache.org/doc/r3.3.3/zookeeperStarted.html",children:"ZooKeeper"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://redis.io/topics/quickstart",children:"Redis"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/SettingUp.html",children:"DynamoDB"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"/docs/v1/basics/installation",children:"installation"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["See the ",(0,s.jsx)(n.a,{href:"/docs/v1/basics/configuration",children:"configuration"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.p,{children:"By default Dkron uses the following ports:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"8946"})," for communicating between agents"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"8080"})," for HTTP for the API and Dashboard"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"6868"})," for RPC comunication between agents."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Be sure you have opened this ports (or the ones that you configured) in your firewall or AWS security groups."})}),"\n",(0,s.jsxs)(n.p,{children:["By default dkron will use the embedded BoltDB KV store. A different store can be specified setting ",(0,s.jsx)(n.code,{children:"backend"})," and ",(0,s.jsx)(n.code,{children:"backend-machines"})," flag in the config file, env variables or as a command line flag."]}),"\n",(0,s.jsx)(n.p,{children:"To start a Dkron server instance:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"dkron agent --server\n"})}),"\n",(0,s.jsx)(n.p,{children:"Time to add the first job:"}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["This job will only run in just one ",(0,s.jsx)(n.code,{children:"dkron_server"})," node due to the node count in the tag. Refer to the ",(0,s.jsx)(n.a,{href:"/docs/usage/target-nodes-spec",children:"target node spec"})," for details."]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl localhost:8080/v1/jobs -XPOST -d \'{\n  "name": "job1",\n  "schedule": "@every 10s",\n  "timezone": "Europe/Berlin",\n  "owner": "Platform Team",\n  "owner_email": "platform@example.com",\n  "disabled": false,\n  "tags": {\n    "dkron_server": "true:1"\n  },\n  "concurrency": "allow",\n  "executor": "shell",\n  "executor_config": {\n    "command": "date"\n  }\n}`\n'})}),"\n",(0,s.jsx)(n.p,{children:"That's it!"}),"\n",(0,s.jsxs)(n.h4,{id:"to-start-configuring-an-ha-installation-of-dkron-follow-the-clustering-guide",children:["To start configuring an HA installation of Dkron follow the ",(0,s.jsx)(n.a,{href:"/docs/usage/clustering",children:"clustering guide"})]})]})}function h(e={}){const{wrapper:n}={...(0,o.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},4552:(e,n,t)=>{t.d(n,{I:()=>a,M:()=>r});var s=t(11504);const o={},i=s.createContext(o);function r(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);