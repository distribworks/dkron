"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[7321],{48193:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>o});var r=i(30758);const s={},t=r.createContext(s);function d(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(t.Provider,{value:n},e.children)}},87238:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"basics/configuration","title":"Configuration","description":"Configuration sources","source":"@site/docs/basics/configuration.md","sourceDirName":"basics","slug":"/basics/configuration","permalink":"/docs/basics/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/distribworks/dkron/tree/main/website/docs/docs/basics/configuration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Getting started","permalink":"/docs/basics/getting-started"},"next":{"title":"Installation","permalink":"/docs/basics/installation"}}');var s=i(86070),t=i(48193);const d={},o="Configuration",c={},l=[{value:"Configuration sources",id:"configuration-sources",level:2},{value:"Config file location",id:"config-file-location",level:2},{value:"Config file example",id:"config-file-example",level:3},{value:"Important Configuration Parameters",id:"important-configuration-parameters",level:2},{value:"Core Configuration",id:"core-configuration",level:3},{value:"Networking and Cluster Formation",id:"networking-and-cluster-formation",level:3},{value:"Node Configuration",id:"node-configuration",level:3},{value:"Performance and Scaling",id:"performance-and-scaling",level:3},{value:"Notification Configuration",id:"notification-configuration",level:3},{value:"Metrics Configuration",id:"metrics-configuration",level:3},{value:"Environment Variables",id:"environment-variables",level:2},{value:"SEE ALSO",id:"see-also",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"configuration",children:"Configuration"})}),"\n",(0,s.jsx)(n.h2,{id:"configuration-sources",children:"Configuration sources"}),"\n",(0,s.jsx)(n.p,{children:"Settings can be specified in three ways (in order of precedence):"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Command line arguments."}),"\n",(0,s.jsxs)(n.li,{children:["Environment variables starting with ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"DKRON_"})})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"dkron.yml"})})," config file"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["Dkron sends anonymous usage data to a server with the purpose of elaborating usage statistics, if you want to disable statistics collection, you can disable it in the dkron config file or in the command line using ",(0,s.jsx)(n.code,{children:"--disable-usage-stats"})," parameter"]})}),"\n",(0,s.jsx)(n.h2,{id:"config-file-location",children:"Config file location"}),"\n",(0,s.jsx)(n.p,{children:"Config file will be loaded from the following paths:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"/etc/dkron"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"$HOME/.dkron"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"./config"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"config-file-example",children:"Config file example"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'# Dkron example configuration file\n# server: false\n# bootstrap-expect: 3\n# data-dir: dkron.data\n# log-level: debug\n# tags:\n#   dc: east\n# encrypt: a-valid-key-generated-with-dkron-keygen\n# retry-join:\n#   - 10.0.0.1\n#   - 10.0.0.2\n#   - 10.0.0.3\n# raft-multiplier: 1\n# webhook-url: https://hooks.slack.com/services/XXXXXX/XXXXXXX/XXXXXXXXXXXXXXXXXXXX\n# webhook-payload: "payload={\\"text\\": \\"{{.Report}}\\", \\"channel\\": \\"#foo\\"}"\n# webhook-headers: Content-Type:application/x-www-form-urlencoded\n# mail-host: email-smtp.eu-west-1.amazonaws.com\n# mail-port: 25\n# mail-username": mailuser\n# mail-password": mailpassword\n# mail-from": cron@example.com\n# mail-subject_prefix: [Dkron]\n# mail-payload: "Job {{.JobName}} finished with status {{.Success}} on node {{.NodeName}}\\n\\nOutput:\\n{{.Output}}"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"important-configuration-parameters",children:"Important Configuration Parameters"}),"\n",(0,s.jsx)(n.p,{children:"Here's a detailed explanation of the key configuration parameters:"}),"\n",(0,s.jsx)(n.h3,{id:"core-configuration",children:"Core Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"server"})}),(0,s.jsxs)(n.td,{children:["When set to ",(0,s.jsx)(n.code,{children:"true"}),", the agent runs in server mode and participates in leader election. Default: ",(0,s.jsx)(n.code,{children:"false"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bootstrap-expect"})}),(0,s.jsx)(n.td,{children:"Number of expected servers in the cluster. When this many servers are available, Dkron will bootstrap the cluster and start a leader election. This helps automate cluster formation."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"data-dir"})}),(0,s.jsxs)(n.td,{children:["Directory for storing server-specific data including the replicated log. Default: ",(0,s.jsx)(n.code,{children:"dkron.data"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"log-level"})}),(0,s.jsxs)(n.td,{children:["Log verbosity level: ",(0,s.jsx)(n.code,{children:"debug"}),", ",(0,s.jsx)(n.code,{children:"info"}),", ",(0,s.jsx)(n.code,{children:"warn"}),", ",(0,s.jsx)(n.code,{children:"error"}),", ",(0,s.jsx)(n.code,{children:"fatal"}),", ",(0,s.jsx)(n.code,{children:"panic"}),". Default: ",(0,s.jsx)(n.code,{children:"info"})]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"networking-and-cluster-formation",children:"Networking and Cluster Formation"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"bind-addr"})}),(0,s.jsxs)(n.td,{children:["Address to bind for network services. Uses go-sockaddr template format. Default: ",(0,s.jsx)(n.code,{children:"{{ GetPrivateIP }}:8946"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"http-addr"})}),(0,s.jsxs)(n.td,{children:["Address to bind the UI web server to. Format: ",(0,s.jsx)(n.code,{children:":8080"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"advertise-addr"})}),(0,s.jsx)(n.td,{children:"Address advertised to other nodes. Uses the bind address by default."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"advertise-rpc-port"})}),(0,s.jsxs)(n.td,{children:["RPC port advertised to clients. Uses ",(0,s.jsx)(n.code,{children:"rpc-port"})," by default."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"rpc-port"})}),(0,s.jsxs)(n.td,{children:["Port used for RPC communication with clients. Default: ",(0,s.jsx)(n.code,{children:"6868"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"join"})}),(0,s.jsx)(n.td,{children:"Initial agent to join with. Can be specified multiple times."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"retry-join"})}),(0,s.jsx)(n.td,{children:"Address of agent to join with retries. Can be specified multiple times."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"retry-interval"})}),(0,s.jsxs)(n.td,{children:["Time to wait between join attempts. Default: ",(0,s.jsx)(n.code,{children:"30s"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"retry-max"})}),(0,s.jsxs)(n.td,{children:["Maximum number of join attempts. ",(0,s.jsx)(n.code,{children:"0"})," means retry indefinitely."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"encrypt"})}),(0,s.jsxs)(n.td,{children:["Key for encrypting network traffic. Must be a base64-encoded 16-byte key generated by ",(0,s.jsx)(n.code,{children:"dkron keygen"})]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"node-configuration",children:"Node Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"node-name"})}),(0,s.jsx)(n.td,{children:"Name of this node. Must be unique in the cluster. Default: system hostname"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"datacenter"})}),(0,s.jsxs)(n.td,{children:["Data center of the local agent. All members of a datacenter should share a LAN connection. Default: ",(0,s.jsx)(n.code,{children:"dc1"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"region"})}),(0,s.jsxs)(n.td,{children:["Region the agent belongs to. A region typically maps to a geographic region. Default: ",(0,s.jsx)(n.code,{children:"global"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"tag"})}),(0,s.jsxs)(n.td,{children:["Attach key/value tag pairs to the node. Format: ",(0,s.jsx)(n.code,{children:"key=value"}),". Can be specified multiple times."]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"performance-and-scaling",children:"Performance and Scaling"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"raft-multiplier"})}),(0,s.jsxs)(n.td,{children:["Integer multiplier for Raft timing parameters. Lower values increase sensitivity to failures but require more resources. 1 is high-performance, 10 is max. Default: ",(0,s.jsx)(n.code,{children:"1"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"profile"})}),(0,s.jsxs)(n.td,{children:["Controls timing profiles. Options: ",(0,s.jsx)(n.code,{children:"lan"}),", ",(0,s.jsx)(n.code,{children:"wan"}),", etc. Default: ",(0,s.jsx)(n.code,{children:"lan"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"serf-reconnect-timeout"})}),(0,s.jsxs)(n.td,{children:["Time to attempt reconnection to failed nodes before removing them. Default: ",(0,s.jsx)(n.code,{children:"24h"})]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"notification-configuration",children:"Notification Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"webhook-endpoint"})}),(0,s.jsx)(n.td,{children:"Endpoint URL to call for webhook notifications."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"webhook-payload"})}),(0,s.jsx)(n.td,{children:"Body of the POST request to send when calling the webhook."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"webhook-headers"})}),(0,s.jsx)(n.td,{children:"Headers to use when calling the webhook URL. Can be specified multiple times."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mail-host"})}),(0,s.jsx)(n.td,{children:"Mail server hostname for sending notifications."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mail-port"})}),(0,s.jsx)(n.td,{children:"Mail server port."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mail-username"})}),(0,s.jsx)(n.td,{children:"Username for mail server authentication."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mail-password"})}),(0,s.jsx)(n.td,{children:"Password for mail server authentication."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mail-from"})}),(0,s.jsx)(n.td,{children:"From email address to use in notifications."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mail-subject-prefix"})}),(0,s.jsxs)(n.td,{children:["Prefix for the email subject line. Default: ",(0,s.jsx)(n.code,{children:"[Dkron]"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"mail-payload"})}),(0,s.jsxs)(n.td,{children:["Custom Go template for the email body. If not set, defaults to the execution output. Available template variables: ",(0,s.jsx)(n.code,{children:"{{.Report}}"}),", ",(0,s.jsx)(n.code,{children:"{{.JobName}}"}),", ",(0,s.jsx)(n.code,{children:"{{.ReportingNode}}"}),", ",(0,s.jsx)(n.code,{children:"{{.StartTime}}"}),", ",(0,s.jsx)(n.code,{children:"{{.FinishedAt}}"}),", ",(0,s.jsx)(n.code,{children:"{{.Success}}"}),", ",(0,s.jsx)(n.code,{children:"{{.NodeName}}"}),", ",(0,s.jsx)(n.code,{children:"{{.Output}}"})]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"metrics-configuration",children:"Metrics Configuration"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"statsd-addr"})}),(0,s.jsx)(n.td,{children:"Address of a statsd server for metrics collection."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"dog-statsd-addr"})}),(0,s.jsx)(n.td,{children:"Address of a DataDog statsd agent."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"dog-statsd-tags"})}),(0,s.jsxs)(n.td,{children:["Tags to include with DataDog metrics. Format: ",(0,s.jsx)(n.code,{children:"key:value"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"enable-prometheus"})}),(0,s.jsxs)(n.td,{children:["When ",(0,s.jsx)(n.code,{children:"true"}),", enables serving Prometheus metrics at the ",(0,s.jsx)(n.code,{children:"/metrics"})," endpoint."]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,s.jsx)(n.p,{children:"All configuration options can also be specified as environment variables by:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Converting to uppercase"}),"\n",(0,s.jsx)(n.li,{children:"Replacing dashes with underscores"}),"\n",(0,s.jsxs)(n.li,{children:["Prefixing with ",(0,s.jsx)(n.code,{children:"DKRON_"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Example: ",(0,s.jsx)(n.code,{children:"server: true"})," becomes ",(0,s.jsx)(n.code,{children:"DKRON_SERVER=true"})]}),"\n",(0,s.jsx)(n.h3,{id:"see-also",children:"SEE ALSO"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/cli/dkron_agent/",children:"dkron agent"}),"\t - Start a dkron agent"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/cli/dkron_doc/",children:"dkron doc"}),"\t - Generate Markdown documentation for the Dkron CLI."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/cli/dkron_keygen/",children:"dkron keygen"}),"\t - Generates a new encryption key"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/docs/cli/dkron_version/",children:"dkron version"}),"\t - Show version"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}}}]);